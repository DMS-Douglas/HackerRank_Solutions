# Douglas Souza
# Hacker Rank - SQL Challenges - Submissions (Medium/Hard)

[![Hacker Rank Logo](https://hrcdn.net/hackerrank/assets/brand/h_mark_sm-9c05999c62674028552f4e813728e591.svg)](https://www.hackerrank.com/douglas15) - [![Golden Badges](../badges.png)](https://www.hackerrank.com/douglas15)

The PADS (https://www.hackerrank.com/challenges/the-pads/problem)

```sql
SELECT
    O.NAME || '(' || SUBSTR(O.OCCUPATION, 1, 1) || ')'
FROM OCCUPATIONS O
ORDER BY O.NAME;
```

```sql
SElECT
    'There are a total of ' || COUNT(1) || ' ' || LOWER(O.OCCUPATION) || 's.' 
    --COUNT(1),
    --O.OCCUPATION
FROM OCCUPATIONS O
GROUP BY O.OCCUPATION
ORDER BY COUNT(1), O.OCCUPATION
;
```


Occupations (https://www.hackerrank.com/challenges/occupations/problem)

```sql
WITH ALL_ITEMS AS (
    SELECT SUM(1) OVER(ORDER BY ROWNUM) AS ID, O.NAME, O.OCCUPATION 
    FROM OCCUPATIONS O 
), ALL_DOCTORS AS (
    SELECT SUM(1) OVER(ORDER BY O.NAME) AS ID, O.NAME, O.OCCUPATION 
    FROM OCCUPATIONS O 
    WHERE O.OCCUPATION = 'Doctor'
    ORDER BY O.NAME 
), ALL_PROFESSORS AS (
    SELECT SUM(1) OVER(ORDER BY O.NAME) AS ID, O.NAME, O.OCCUPATION 
    FROM OCCUPATIONS O 
    WHERE O.OCCUPATION = 'Professor'
    ORDER BY O.NAME 
), ALL_SINGERS AS (
    SELECT SUM(1) OVER(ORDER BY O.NAME) AS ID, O.NAME, O.OCCUPATION 
    FROM OCCUPATIONS O 
    WHERE O.OCCUPATION = 'Singer'
    ORDER BY O.NAME 
), ALL_ACTORS AS (
    SELECT SUM(1) OVER(ORDER BY O.NAME) AS ID, O.NAME, O.OCCUPATION 
    FROM OCCUPATIONS O 
    WHERE O.OCCUPATION = 'Actor'
    ORDER BY O.NAME 
) 
SELECT 
    ALL_DOCTORS.NAME,
    ALL_PROFESSORS.NAME, 
    ALL_SINGERS.NAME, 
    ALL_ACTORS.NAME 
FROM ALL_ITEMS 
LEFT JOIN ALL_DOCTORS ON (
        ALL_DOCTORS.ID = ALL_ITEMS.ID
)
LEFT JOIN ALL_PROFESSORS ON (
        ALL_PROFESSORS.ID = ALL_ITEMS.ID
)
LEFT JOIN ALL_SINGERS ON (
        ALL_SINGERS.ID = ALL_ITEMS.ID
)
LEFT JOIN ALL_ACTORS ON (
        ALL_ACTORS.ID = ALL_ITEMS.ID
)
WHERE (
    ALL_DOCTORS.NAME IS NOT NULL
    OR ALL_PROFESSORS.NAME IS NOT NULL
    OR ALL_SINGERS.NAME IS NOT NULL 
    OR ALL_ACTORS.NAME IS NOT NULL
)
ORDER BY ALL_ITEMS.ID
;
```

Binary Tree Nodes (https://www.hackerrank.com/challenges/binary-search-tree-1/problem)

```sql
SELECT * FROM (
    SELECT 
        BST.N N, 
        CASE 
            WHEN (BST.P IS NULL) THEN 'Root' 
            WHEN (BST.P IS NOT NULL AND CHILD.N IS NOT NULL) THEN 'Inner' 
            WHEN (BST.P IS NOT NULL AND CHILD.N IS NULL) THEN 'Leaf' 
            ELSE 'NOT CLASSIFIED' 
        END AS NODE_TYPE 
    FROM BST
    LEFT JOIN BST CHILD ON (
        CHILD.P = BST.N
    )
    ORDER BY BST.N 
)
GROUP BY N, NODE_TYPE
ORDER BY N 
;
```

New Companies (https://www.hackerrank.com/challenges/the-company/problem)

```sql
SELECT 
    --COUNT(1) OVER(), 
    C.COMPANY_CODE, 
    C.FOUNDER, 
    COUNT(DISTINCT LM.LEAD_MANAGER_CODE), 
    COUNT(DISTINCT SM.SENIOR_MANAGER_CODE), 
    COUNT(DISTINCT M.MANAGER_CODE), 
    COUNT(DISTINCT E.EMPLOYEE_CODE) 
FROM COMPANY C 
LEFT JOIN LEAD_MANAGER LM ON (LM.COMPANY_CODE = C.COMPANY_CODE) 
LEFT JOIN SENIOR_MANAGER SM ON (
    SM.LEAD_MANAGER_CODE = LM.LEAD_MANAGER_CODE 
    AND SM.COMPANY_CODE = LM.COMPANY_CODE 
) 
LEFT JOIN MANAGER M ON (
    M.SENIOR_MANAGER_CODE = SM.SENIOR_MANAGER_CODE 
    AND M.LEAD_MANAGER_CODE = SM.LEAD_MANAGER_CODE 
    AND M.COMPANY_CODE = SM.COMPANY_CODE 
) 
LEFT JOIN EMPLOYEE E ON (
    E.MANAGER_CODE = M.MANAGER_CODE 
    AND E.SENIOR_MANAGER_CODE = M.SENIOR_MANAGER_CODE 
    AND E.LEAD_MANAGER_CODE = M.LEAD_MANAGER_CODE 
    AND E.COMPANY_CODE = M.COMPANY_CODE 
)
GROUP BY C.COMPANY_CODE, C.FOUNDER
ORDER BY C.COMPANY_CODE 
;
```


Weather Observation Station 18 (https://www.hackerrank.com/challenges/weather-observation-station-18/problem)

```sql
WITH TEMP_VARIABLES AS (
    SELECT 
        MIN(S.LAT_N) P_1_A, 
        MIN(S.LONG_W) P_1_B, 
        MAX(S.LAT_N) P_2_C, 
        MAX(S.LONG_W) P_2_D 
    FROM STATION S
)
SELECT 
    ROUND((ABS(P_1_A - P_2_C) + ABS(P_1_B - P_2_D)), 4) 
FROM TEMP_VARIABLES P
;
```


Weather Observation Station 19 (https://www.hackerrank.com/challenges/weather-observation-station-19/problem)

```sql
WITH TEMP_VARIABLES AS (
    SELECT 
        MIN(S.LAT_N) P_1_A, 
        MIN(S.LONG_W) P_1_B, 
        MAX(S.LAT_N) P_2_C, 
        MAX(S.LONG_W) P_2_D 
    FROM STATION S
)
SELECT 
    ROUND(
        SQRT(
            POWER(ABS(P_1_A - P_2_C), 2) + POWER(ABS(P_1_B - P_2_D), 2)
        )
    , 4) 
FROM TEMP_VARIABLES P
;
```

Weather Observation Station 20 (https://www.hackerrank.com/challenges/weather-observation-station-20/problem)

```sql
SELECT
    ROUND(MEDIAN(S.LAT_N), 4)
FROM STATION S
;
```

The Report (https://www.hackerrank.com/challenges/the-report/problem)

```sql
SELECT 
    (CASE WHEN G.GRADE >= 8 THEN S.NAME ELSE NULL END) AS NAME, 
    G.GRADE,
    --(SELECT G.GRADE FROM GRADES G WHERE S.MARKS BETWEEN G.MIN_MARK AND G.MAX_MARK) AS GRADE,
    S.MARKS AS MARK
FROM STUDENTS S
LEFT JOIN GRADES G ON (S.MARKS BETWEEN G.MIN_MARK AND G.MAX_MARK)
ORDER BY GRADE DESC, S.NAME ASC
;

```

Top Competitors (https://www.hackerrank.com/challenges/full-score/problem)

```sql
SELECT 
    H.HACKER_ID,
    H.NAME
    --,COUNT(DISTINCT S.CHALLENGE_ID) QT
FROM SUBMISSIONS S
INNER JOIN CHALLENGES C ON (C.CHALLENGE_ID = S.CHALLENGE_ID)
INNER JOIN HACKERS H ON (H.HACKER_ID = S.HACKER_ID)
INNER JOIN DIFFICULTY D ON (D.DIFFICULTY_LEVEL = C.DIFFICULTY_LEVEL)
WHERE D.SCORE = S.SCORE 
HAVING COUNT(DISTINCT S.CHALLENGE_ID) > 1 
GROUP BY H.HACKER_ID, H.NAME 
ORDER BY COUNT(DISTINCT S.CHALLENGE_ID) DESC, H.HACKER_ID ASC
;
```

Ollivander's Inventory (https://www.hackerrank.com/challenges/harry-potter-and-wands/problem)

```sql
WITH TMP_WANDS AS (
    SELECT 
        --COUNT(1),
        W.CODE,
        MIN(W.COINS_NEEDED) MIN_COINS_NEEDED,
        W.POWER POWER,
        WP.AGE AGE
    FROM WANDS W
    INNER JOIN WANDS_PROPERTY WP ON (W.CODE = WP.CODE)
    WHERE WP.IS_EVIL = 0 
    GROUP BY 
        W.POWER,
        WP.AGE,
        W.CODE
)
SELECT 
    W2.ID,
    TW.AGE,
    TW.MIN_COINS_NEEDED,
    TW.POWER
FROM TMP_WANDS TW INNER JOIN WANDS W2 ON (
    TW.CODE = W2.CODE
    AND TW.POWER = W2.POWER
    AND TW.MIN_COINS_NEEDED = W2.COINS_NEEDED
)
ORDER BY TW.POWER DESC, TW.AGE DESC
;
```

Challenges (https://www.hackerrank.com/challenges/challenges/problem)

```sql
SELECT
    HACKER_ID,
    NAME,
    CHALLENGES_CREATED
    --,DUPLICATIONS
    --,MAX_CHALLENGES_OVERALL
FROM (
    SELECT 
        H.HACKER_ID HACKER_ID,
        H.NAME NAME,
        COUNT(C.CHALLENGE_ID) CHALLENGES_CREATED,
        MAX(COUNT(C.CHALLENGE_ID)) OVER() MAX_CHALLENGES_OVERALL,
        COUNT(1) OVER(PARTITION BY COUNT(C.CHALLENGE_ID))-1 AS DUPLICATIONS
    FROM HACKERS H 
    INNER JOIN CHALLENGES C ON (H.HACKER_ID = C.HACKER_ID) 
    GROUP BY H.HACKER_ID, H.NAME
    ORDER BY CHALLENGES_CREATED DESC, H.HACKER_ID
)
WHERE (
    MAX_CHALLENGES_OVERALL = CHALLENGES_CREATED
    OR DUPLICATIONS = 0
)
;
```

Contest Leaderboard (https://www.hackerrank.com/challenges/contest-leaderboard/problem)

```sql
SELECT
    HACKER_ID,
    NAME,
    --CHALLENGE_ID,
    SUM(MAX_SCORE_PER_CHALLENGE) TOTAL_SCORE
FROM (
    SELECT
        H.HACKER_ID HACKER_ID,
        H.NAME NAME,
        S.CHALLENGE_ID CHALLENGE_ID,
        MAX(S.SCORE) MAX_SCORE_PER_CHALLENGE
    FROM HACKERS H
    INNER JOIN SUBMISSIONS S ON (S.HACKER_ID = H.HACKER_ID)
    WHERE S.SCORE > 0
    GROUP BY H.HACKER_ID, H.NAME, S.CHALLENGE_ID
)
GROUP BY HACKER_ID, NAME
ORDER BY TOTAL_SCORE DESC, HACKER_ID
;
```

Projects (https://www.hackerrank.com/challenges/projects/problem)

```sql
SELECT INI, MAX(FIN) FROM ( 
    WITH STARTING_DATES AS ( 
        SELECT 
            PREV.END_DATE PREV_END_DATE, 
            P.START_DATE START_DATE, 
            P.END_DATE END_DATE 
        FROM PROJECTS P 
        LEFT JOIN PROJECTS PREV ON (PREV.END_DATE = P.START_DATE)
        WHERE PREV.END_DATE IS NULL 
        ORDER BY P.START_DATE
    ) 
    SELECT
        CONNECT_BY_ROOT P.START_DATE INI, 
        P.END_DATE FIN 
    FROM PROJECTS P 
    START WITH P.START_DATE IN (SELECT SD.START_DATE FROM STARTING_DATES SD ) 
    CONNECT BY PRIOR P.END_DATE = P.START_DATE 
)
GROUP BY INI 
ORDER BY (MAX(FIN) - INI), INI  
;
```


Placements (https://www.hackerrank.com/challenges/placements/problem)

```sql
SELECT 
    S.NAME 
FROM STUDENTS S 
INNER JOIN PACKAGES SP ON (SP.ID = S.ID) 
INNER JOIN FRIENDS SF ON (SF.ID = S.ID) 
INNER JOIN PACKAGES SFP ON (SFP.ID = SF.FRIEND_ID) 
WHERE SP.SALARY < SFP.SALARY 
ORDER BY SFP.SALARY 
;
```

Symmetric Pairs (https://www.hackerrank.com/challenges/symmetric-pairs/problem)

```sql
SELECT 
    FN1.X, 
    FN1.Y 
FROM FUNCTIONS FN1 
INNER JOIN FUNCTIONS FN2 ON (
    FN1.X = FN2.Y 
    AND FN1.Y = FN2.X 
) 
WHERE FN1.X <= FN1.Y 
HAVING (COUNT(1) > 1) OR (COUNT(1) = 1 AND FN1.X != FN1.Y) 
GROUP BY FN1.X, FN1.Y 
ORDER BY FN1.X ASC
;
```


Print Prime Numbers (https://www.hackerrank.com/challenges/print-prime-numbers/problem)

```sql
WITH NUMBERS AS (
    SELECT 
        COUNT(1) OVER(), 
        LEVEL NUM 
    FROM DUAL 
    CONNECT BY LEVEL <= 1000 
    ORDER BY LEVEL DESC 
) 
SELECT 
    LISTAGG(TMPN.NUM, '&') WITHIN GROUP(ORDER BY TMPN.NUM ASC) 
FROM NUMBERS TMPN 
WHERE (
    (TMPN.NUM BETWEEN 2 AND 3) 
    OR (
        TMPN.NUM > 3 AND REMAINDER(TMPN.NUM, 2) != 0 
        AND NOT EXISTS (
            SELECT 1 
            FROM NUMBERS TMPN2 
            WHERE TMPN2.NUM > 2 --TMPN.NUM 
            AND TMPN2.NUM <= CEIL(SQRT(TMPN.NUM)) 
            AND REMAINDER(TMPN2.NUM, 2) != 0
            AND ABS(REMAINDER(TMPN.NUM, TMPN2.NUM)) = 0 
        ) 
    )
) 
ORDER BY TMPN.NUM 
;
```

Interviews (https://www.hackerrank.com/challenges/interviews/problem)

```sql
WITH VIEW_STATS_SUM AS (
    SELECT
        VS.CHALLENGE_ID AS CHALLENGE_ID,
        SUM(NVL(VS.TOTAL_VIEWS, 0)) AS TOTAL_VIEWS, 
        SUM(NVL(VS.TOTAL_UNIQUE_VIEWS, 0)) AS TOTAL_UNIQUE_VIEWS 
    FROM VIEW_STATS VS
    GROUP BY VS.CHALLENGE_ID 
), SUBMISSION_STATS_SUM AS (
    SELECT
        SS.CHALLENGE_ID AS CHALLENGE_ID, 
        SUM(NVL(SS.TOTAL_SUBMISSIONS, 0)) AS TOTAL_SUBMISSIONS, 
        SUM(NVL(SS.TOTAL_ACCEPTED_SUBMISSIONS, 0)) AS TOTAL_ACCEPTED_SUBMISSIONS 
    FROM SUBMISSION_STATS SS
    GROUP BY SS.CHALLENGE_ID 
)
SELECT 
    CON.CONTEST_ID, 
    CON.HACKER_ID, 
    CON.NAME, 
    SUM(NVL(SS.TOTAL_SUBMISSIONS, 0)) AS TOTAL_SUBMISSIONS, 
    SUM(NVL(SS.TOTAL_ACCEPTED_SUBMISSIONS, 0)) AS TOTAL_ACCEPTED_SUBMISSIONS, 
    SUM(NVL(VS.TOTAL_VIEWS, 0)) AS TOTAL_VIEWS, 
    SUM(NVL(VS.TOTAL_UNIQUE_VIEWS, 0)) AS TOTAL_UNIQUE_VIEWS 
FROM CONTESTS CON 
INNER JOIN COLLEGES COL ON (COL.CONTEST_ID = CON.CONTEST_ID)
INNER JOIN CHALLENGES CHA ON (CHA.COLLEGE_ID = COL.COLLEGE_ID) 
LEFT JOIN VIEW_STATS_SUM VS ON (VS.CHALLENGE_ID = CHA.CHALLENGE_ID) 
LEFT JOIN SUBMISSION_STATS_SUM SS ON (SS.CHALLENGE_ID = CHA.CHALLENGE_ID) 
WHERE ( 
    NVL(SS.TOTAL_SUBMISSIONS, 0) > 0 
    OR NVL(SS.TOTAL_ACCEPTED_SUBMISSIONS, 0) > 0 
    OR NVL(VS.TOTAL_VIEWS, 0) > 0 
    OR NVL(VS.TOTAL_UNIQUE_VIEWS, 0) > 0 
)
GROUP BY CON.CONTEST_ID, CON.HACKER_ID, CON.NAME 
ORDER BY CON.CONTEST_ID 
;
```


15 Days of Learning SQL (https://www.hackerrank.com/challenges/15-days-of-learning-sql/problem)

```sql
WITH SUB_GROUP AS ( 
    SELECT 
        H.HACKER_ID, 
        H.NAME, 
        SD.SUBMISSION_DATE, 
        COUNT(1) TOTAL_SUBMISSIONS,
        SUM(SD.SCORE) SCORE_SUM 
    FROM SUBMISSIONS SD 
    INNER JOIN HACKERS H ON (H.HACKER_ID = SD.HACKER_ID) 
    WHERE SD.SUBMISSION_DATE 
    BETWEEN TO_DATE('2016/03/01', 'YYYY/MM/DD') AND TO_DATE('2016/03/15', 'YYYY/MM/DD') 
    GROUP BY H.HACKER_ID, H.NAME, SD.SUBMISSION_DATE 
    ORDER BY SD.SUBMISSION_DATE 
), 
UNIQUE_SUBMITTERS_BY_DATE AS ( 
    SELECT 
        SUBMISSION_DATE, 
        COUNT(DISTINCT HACKER_ID) TOTAL_DISTINCT_SUBMISSIONS 
    FROM ( 
        SELECT 
            SG.SUBMISSION_DATE, 
            SG.HACKER_ID, 
            (
                SELECT COUNT(DISTINCT SSG.SUBMISSION_DATE) 
                FROM SUB_GROUP SSG 
                WHERE SSG.HACKER_ID = SG.HACKER_ID 
                AND SSG.SUBMISSION_DATE 
                BETWEEN TO_DATE('2016/03/01', 'YYYY/MM/DD') AND SG.SUBMISSION_DATE 
            ) TOTAL_SUBMISSIONS, 
            (SG.SUBMISSION_DATE - TO_DATE('2016/03/01', 'YYYY/MM/DD')+1) MAX_SUBMISSIONS_POSSIBLE 
        FROM SUB_GROUP SG 
    ) 
    WHERE TOTAL_SUBMISSIONS = MAX_SUBMISSIONS_POSSIBLE 
    GROUP BY SUBMISSION_DATE 
), 
DAILY_MAX_SUBMISSIONS AS ( 
    SELECT 
        SG.SUBMISSION_DATE, 
        MAX(SG.TOTAL_SUBMISSIONS) MAX_TOTAL_SUBMISSIONS 
    FROM SUB_GROUP SG 
    GROUP BY SG.SUBMISSION_DATE 
), 
SUB_GROUP_DAILY_LEADER AS ( 
    SELECT * FROM ( 
        SELECT 
            SG.SUBMISSION_DATE, 
            SG.HACKER_ID, 
            SG.NAME,
            SUM(1) OVER(
                PARTITION BY SG.SUBMISSION_DATE ORDER BY SG.HACKER_ID ASC
            ) HACKER_ID_ORDER 
        FROM SUB_GROUP SG 
        WHERE EXISTS ( 
            SELECT 1 FROM 
            DAILY_MAX_SUBMISSIONS DMS 
            WHERE DMS.SUBMISSION_DATE = SG.SUBMISSION_DATE 
            AND DMS.MAX_TOTAL_SUBMISSIONS = SG.TOTAL_SUBMISSIONS 
        ) 
        GROUP BY SG.SUBMISSION_DATE, SG.HACKER_ID, SG.NAME 
        ) 
    WHERE HACKER_ID_ORDER = 1 
) 
SELECT 
    SG.SUBMISSION_DATE, 
    USBD.TOTAL_DISTINCT_SUBMISSIONS, 
    SGDL.HACKER_ID, 
    SGDL.NAME 
FROM SUB_GROUP SG 
LEFT JOIN SUB_GROUP_DAILY_LEADER SGDL ON (SGDL.SUBMISSION_DATE = SG.SUBMISSION_DATE) 
LEFT JOIN UNIQUE_SUBMITTERS_BY_DATE USBD ON (USBD.SUBMISSION_DATE = SG.SUBMISSION_DATE) 
GROUP BY SG.SUBMISSION_DATE, SGDL.HACKER_ID, SGDL.NAME, USBD.TOTAL_DISTINCT_SUBMISSIONS 
ORDER BY SG.SUBMISSION_DATE 
;
```